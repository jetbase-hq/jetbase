{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Jetbase \ud83d\ude80","text":"<p>Jetbase is a simple, lightweight database migration tool for Python projects.</p> <p>Jetbase helps you manage database migrations in a simple, version-controlled way. Whether you're adding a new table, modifying columns, or need to undo a change, Jetbase makes it super easy!</p>"},{"location":"#key-features","title":"Key Features \u2728","text":"<ul> <li>\ud83d\udce6 Simple Setup \u2014 Get started with just one command</li> <li>\u2b06\ufe0f Easy Upgrades \u2014 Apply pending migrations with confidence</li> <li>\u2b07\ufe0f Safe Rollbacks \u2014 Made a mistake? No problem, roll it back!</li> <li>\ud83d\udcca Clear Status \u2014 Always know which migrations have been applied and which are pending</li> <li>\ud83d\udd12 Migration Locking \u2014 Prevents conflicts when multiple processes try to migrate</li> <li>\u2705 Checksum Validation \u2014 Detects if migration files have been modified</li> <li>\ud83d\udd04 Repeatable Migrations \u2014 Support for migrations that run on every upgrade</li> </ul>"},{"location":"#quick-start","title":"Quick Start \ud83c\udfc3\u200d\u2642\ufe0f","text":""},{"location":"#installation","title":"Installation","text":"pipuv <pre><code>pip install jetbase\n</code></pre> <pre><code>uv add jetbase\n</code></pre>"},{"location":"#initialize-your-project","title":"Initialize Your Project","text":"<pre><code>jetbase init\ncd jetbase\n</code></pre> <p>This creates a <code>jetbase/</code> directory with:</p> <ul> <li>A <code>migrations/</code> folder for your SQL files</li> <li>An <code>env.py</code> configuration file</li> </ul>"},{"location":"#configure-your-database","title":"Configure Your Database","text":"<p>Edit <code>jetbase/env.py</code> with your database connection string:</p> PostgreSQLMySQLSQLiteSnowflake <pre><code>sqlalchemy_url = \"postgresql+psycopg2://user:password@localhost:5432/mydb\"\n</code></pre> <pre><code>sqlalchemy_url = \"mysql+pymysql://user:password@localhost:3306/mydb\"\n</code></pre> <pre><code>sqlalchemy_url = \"sqlite:///mydb.db\"\n</code></pre> <pre><code>sqlalchemy_url = \"snowflake://user:password@account/database/schema?warehouse=WAREHOUSE\"\n</code></pre>"},{"location":"#create-your-first-migration","title":"Create Your First Migration","text":"<pre><code>jetbase new \"create users table\" -v 1\n</code></pre> <p>This creates a new SQL file called <code>V1__create_users_table.sql</code>.</p>"},{"location":"#write-your-migration","title":"Write Your Migration","text":"<p>Open the newly created file and add your SQL:</p> <pre><code>-- upgrade\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL\n);\n\nCREATE TABLE items (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n);\n\n-- rollback\nDROP TABLE items;\nDROP TABLE users;\n</code></pre>"},{"location":"#apply-the-migration","title":"Apply the Migration","text":"<pre><code>jetbase upgrade\n</code></pre> <p>That's it! Your database is now up to date. \ud83c\udf89</p> <p>Note: Jetbase uses SQLAlchemy under the hood to manage database connections. For any database other than SQLite, you must install the appropriate Python database driver. For example, to use Jetbase with PostgreSQL:</p> <pre><code>pip install psycopg2\n</code></pre> <p>You can also use another compatible driver if you prefer (such as <code>asyncpg</code>, <code>pg8000</code>, etc.).</p>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>\ud83d\udcd6 Getting Started Guide \u2014 More detailed setup instructions</li> <li>\ud83d\udee0\ufe0f Commands Reference \u2014 Learn all available commands</li> <li>\ud83d\udcdd Writing Migrations \u2014 Best practices for migration files</li> <li>\u2699\ufe0f Configuration \u2014 Customize Jetbase for your needs</li> </ul>"},{"location":"#supported-databases","title":"Supported Databases","text":"<p>Jetbase currently supports:</p> <ul> <li>\u2705 PostgreSQL</li> <li>\u2705 SQLite</li> <li>\u2705 Snowflake</li> <li>\u2705 MySQL</li> </ul>"},{"location":"configuration/","title":"Configuration \u2699\ufe0f","text":""},{"location":"configuration/#configuration-options","title":"Configuration Options","text":"Option Environment Variable Allowed Values Default <code>sqlalchemy_url</code> <code>JETBASE_SQLALCHEMY_URL</code> SQLAlchemy connection string (required) <code>postgres_schema</code> <code>JETBASE_POSTGRES_SCHEMA</code> Any valid schema name <code>None</code> (uses <code>public</code>) <code>skip_validation</code> <code>JETBASE_SKIP_VALIDATION</code> <code>True</code> / <code>False</code> <code>False</code> <code>skip_checksum_validation</code> <code>JETBASE_SKIP_CHECKSUM_VALIDATION</code> <code>True</code> / <code>False</code> <code>False</code> <code>skip_file_validation</code> <code>JETBASE_SKIP_FILE_VALIDATION</code> <code>True</code> / <code>False</code> <code>False</code> <code>snowflake_private_key</code> <code>JETBASE_SNOWFLAKE_PRIVATE_KEY</code> PEM/multi-line string <code>None</code> <code>snowflake_private_key_password</code> <code>JETBASE_SNOWFLAKE_PRIVATE_KEY_PASSWORD</code> password string <code>None</code> <p>Jetbase uses a simple Python configuration file (<code>env.py</code>) to manage your database connection and behavior settings.</p> <p>For flexibility, you can also set config options as environment variables, in <code>jetbase.toml</code>, or in <code>pyproject.toml</code>.</p>"},{"location":"configuration/#configuration-sources","title":"Configuration Sources","text":"<p>Jetbase loads configuration from four sources, checked in the following priority order:</p> Priority Source Location 1 <code>env.py</code> <code>jetbase/env.py</code> 2 Environment variables <code>JETBASE_{OPTION_NAME}</code> (see example) 3 <code>jetbase.toml</code> <code>jetbase/jetbase.toml</code> (file must be manually created) 4 <code>pyproject.toml</code> <code>[tool.jetbase]</code> section <p>The first source that defines a value wins. For example, if <code>sqlalchemy_url</code> is set in both <code>env.py</code> and as an environment variable, the <code>env.py</code> value is used.</p>"},{"location":"configuration/#example-setting-sqlalchemy_url","title":"Example: Setting <code>sqlalchemy_url</code>","text":"env.pyEnvironment Variablejetbase.tomlpyproject.toml <pre><code># jetbase/env.py\nsqlalchemy_url = \"postgresql://user:password@localhost:5432/mydb\"\n</code></pre> <pre><code>export JETBASE_SQLALCHEMY_URL=\"postgresql://user:password@localhost:5432/mydb\"\n</code></pre> <pre><code># jetbase/jetbase.toml\nsqlalchemy_url = \"postgresql://user:password@localhost:5432/mydb\"\n</code></pre> <pre><code># pyproject.toml\n[tool.jetbase]\nsqlalchemy_url = \"postgresql://user:password@localhost:5432/mydb\"\n</code></pre>"},{"location":"configuration/#sqlalchemy_url-required","title":"<code>sqlalchemy_url</code> (Required)","text":"<p>The database connection string in SQLAlchemy format.</p> PostgreSQLMySQLSQLiteSnowflakeDatabricks <pre><code>sqlalchemy_url = \"postgresql://username:password@host:port/database\"\n</code></pre> <pre><code>sqlalchemy_url = \"mysql+pymysql://username:password@host:port/database\"\n</code></pre> <pre><code>sqlalchemy_url = \"sqlite:///path/to/database.db\"\n</code></pre> <pre><code>sqlalchemy_url = \"snowflake://username:password@account/database/schema?warehouse=WAREHOUSE\"\n</code></pre> <pre><code>sqlalchemy_url = \"databricks://token:&lt;ACCESS_TOKEN&gt;@hostname?http_path=&lt;HTTP_PATH&gt;&amp;catalog=&lt;CATALOG&gt;&amp;schema=&lt;SCHEMA&gt;\"\n</code></pre>"},{"location":"configuration/#postgres_schema","title":"<code>postgres_schema</code>","text":"<p>Optional (even for PostgreSQL databases)</p> <p>Specify a PostgreSQL schema to use for migrations if using a PostgreSQL database. If not set, uses the default <code>public</code> schema.</p> <pre><code>postgres_schema = \"my_schema\"\n</code></pre>"},{"location":"configuration/#skip_checksum_validation","title":"<code>skip_checksum_validation</code>","text":"<p>(Optional)</p> <p>Skips checksum validations</p> <pre><code>skip_checksum_validation = False  # Default\n</code></pre> <p>When to use this</p> <p>Only set this to <code>True</code> if you intentionally modified a migration file and want to skip the checksum check. It's generally better to use <code>jetbase fix-checksums</code> instead.</p>"},{"location":"configuration/#skip_file_validation","title":"<code>skip_file_validation</code>","text":"<p>(Optional)</p> <p>Skip file validations (see File Validations for details).</p> <pre><code>skip_file_validation = False  # Default\n</code></pre>"},{"location":"configuration/#skip_validation","title":"<code>skip_validation</code>","text":"<p>(Optional)</p> <p>Skips both checksum and file validation checks when running migrations. See Validation Types for details. Use with caution!</p> <pre><code>skip_validation = False  # Default\n</code></pre> <p>When set to <code>True</code>, skips both checksum and file validation.</p>"},{"location":"configuration/#snowflake_private_key","title":"<code>snowflake_private_key</code>","text":"<p>(Optional, for Snowflake key pair authentication)</p> <p>This is only needed if connecting to Snowflake and you're using private key authentication instead of username/password.</p> <pre><code>export JETBASE_SNOWFLAKE_PRIVATE_KEY=\"\"\"-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFA...\n-----END PRIVATE KEY-----\"\"\"\n</code></pre> <p>Tip</p> <p>It's best to use environment variable for this and read your private key file in as the environment variable. <pre><code>export JETBASE_SNOWFLAKE_PRIVATE_KEY=$(cat snowflake_private_key.pem)\n</code></pre></p>"},{"location":"configuration/#snowflake_private_key_password","title":"<code>snowflake_private_key_password</code>","text":"<p>(Optional, for encrypted keys)</p> <p>The password to decrypt your PEM-encoded private key if it is password-protected.</p> <pre><code>export SNOWFLAKE_PRIVATE_KEY_PASSWORD=my-secret-password\n</code></pre>"},{"location":"configuration/#command-line-overrides","title":"Command-Line Overrides","text":"<p>Some configuration options can be overridden via command-line flags:</p> <pre><code># Skip all validation\njetbase upgrade --skip-validation\n\n# Skip only checksum validation\njetbase upgrade --skip-checksum-validation\n\n# Skip only file validation\njetbase upgrade --skip-file-validation\n</code></pre>"},{"location":"configuration/#database-tables","title":"Database Tables","text":"<p>Jetbase creates two tables in your database to track migrations:</p> Table Purpose <code>jetbase_migrations</code> Stores migration history (version, checksum, applied timestamp) <code>jetbase_lock</code> Prevents concurrent migrations from running <p>These tables are created automatically when you run your first migration.</p>"},{"location":"database-connections/","title":"Database Connections \ud83d\udd0c","text":"<p>Jetbase supports multiple databases. This guide covers how to connect to each supported database using a SQLAlchemy url.</p>"},{"location":"database-connections/#postgresql","title":"PostgreSQL","text":""},{"location":"database-connections/#installing-a-driver","title":"Installing a Driver","text":"<p>PostgreSQL requires a database driver. Examples:</p> <pre><code>pip install psycopg2-binary\n\npip install \"psycopg[binary]\"\n</code></pre>"},{"location":"database-connections/#connection-string","title":"Connection String","text":"<pre><code>sqlalchemy_url = \"postgresql+driver://username:password@host:port/database\"\n</code></pre>"},{"location":"database-connections/#example","title":"Example","text":"<pre><code># jetbase/env.py\nsqlalchemy_url = \"postgresql+psycopg2://myuser:mypassword@localhost:5432/myapp\"\n</code></pre> <p>With a specific schema:</p> <pre><code># jetbase/env.py\nsqlalchemy_url = \"postgresql://myuser:mypassword@localhost:5432/myapp\"\npostgres_schema = \"public\"\n</code></pre>"},{"location":"database-connections/#snowflake","title":"Snowflake","text":"<p>Snowflake is a cloud-based data warehouse. Jetbase supports both username/password and key pair authentication.</p>"},{"location":"database-connections/#installing-the-driver","title":"Installing the Driver","text":"<p>Snowflake requires additional dependencies. Install Jetbase with the Snowflake extra:</p> <pre><code>pip install \"jetbase[snowflake]\"\n</code></pre>"},{"location":"database-connections/#connection-string-format","title":"Connection String Format","text":"<pre><code>sqlalchemy_url = \"snowflake://username:password@account/database/schema?warehouse=WAREHOUSE_NAME\"\n</code></pre> Component Description <code>username</code> Your Snowflake username <code>password</code> Your Snowflake password (omit for key pair auth) <code>account</code> Your Snowflake account identifier (e.g., <code>abc12345.us-east-1</code>) <code>database</code> Target database name <code>schema</code> Target schema name <code>warehouse</code> Compute warehouse to use"},{"location":"database-connections/#username-password-authentication","title":"Username &amp; Password Authentication","text":"<p>The simplest way to connect is with username and password:</p> <pre><code># jetbase/env.py\nsqlalchemy_url = \"snowflake://myuser:mypassword@myaccount.us-east-1/my_db/public?warehouse=COMPUTE_WH\"\n</code></pre>"},{"location":"database-connections/#key-pair-authentication","title":"Key Pair Authentication","text":"<p>For enhanced security, Snowflake supports key pair authentication. To use it, omit the password from your connection string and configure your private key.</p> <p>Step 1: Create a connection string without a password:</p> <pre><code># jetbase/env.py\nsqlalchemy_url = \"snowflake://myuser@myaccount.us-east-1/my_db/public?warehouse=COMPUTE_WH\"\n</code></pre> <p>Step 2: Configure your private key as an environment variable:</p> <pre><code># Set the private key (PEM format)\nexport JETBASE_SNOWFLAKE_PRIVATE_KEY=\"-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASC...\n-----END PRIVATE KEY-----\"\n\n# Optional: if your private key is encrypted\nexport JETBASE_SNOWFLAKE_PRIVATE_KEY_PASSWORD=\"your-key-password\"\n</code></pre> <p>Tip</p> <p>It's best to read your private key file directly into the environment variable locally:</p> <pre><code>export JETBASE_SNOWFLAKE_PRIVATE_KEY=$(cat snowflake_private_key.pem)\n</code></pre>"},{"location":"database-connections/#sqlite","title":"SQLite","text":""},{"location":"database-connections/#connection-string_1","title":"Connection String","text":"<p>SQLite doesn't require any additional drivers. Just connect with the connection string.</p> <pre><code>sqlalchemy_url = \"sqlite:///path/to/database.db\"\n</code></pre>"},{"location":"database-connections/#examples","title":"Examples","text":"<p>Relative path (relative to where you run Jetbase):</p> <pre><code># jetbase/env.py\nsqlalchemy_url = \"sqlite:///myapp.db\"\n</code></pre> <p>In-memory database (useful for testing):</p> <pre><code># jetbase/env.py\nsqlalchemy_url = \"sqlite:///:memory:\"\n</code></pre>"},{"location":"database-connections/#mysql","title":"MySQL","text":""},{"location":"database-connections/#installing-a-driver_1","title":"Installing a Driver","text":"<p>MySQL requires the PyMySQL driver:</p> <pre><code>pip install pymysql\n</code></pre>"},{"location":"database-connections/#connection-string_2","title":"Connection String","text":"<pre><code>sqlalchemy_url = \"mysql+pymysql://username:password@host:port/database\"\n</code></pre>"},{"location":"database-connections/#example_1","title":"Example","text":"<pre><code># jetbase/env.py\nsqlalchemy_url = \"mysql+pymysql://myuser:mypassword@localhost:3306/myapp\"\n</code></pre>"},{"location":"database-connections/#databricks","title":"Databricks","text":""},{"location":"database-connections/#installing-the-driver_1","title":"Installing the Driver","text":"<p>Databricks requires additional dependencies. Install Jetbase with the Databricks extra:</p> <pre><code>pip install \"jetbase[databricks]\"\n</code></pre>"},{"location":"database-connections/#connection-string-format_1","title":"Connection String Format","text":"<pre><code>sqlalchemy_url = \"databricks://token:ACCESS_TOKEN@HOSTNAME?http_path=HTTP_PATH&amp;catalog=CATALOG&amp;schema=SCHEMA\"\n</code></pre> Component Description <code>ACCESS_TOKEN</code> Your Databricks personal access token <code>HOSTNAME</code> Your Databricks workspace hostname (e.g., <code>adb-1234567890123456.cloud.databricks.com</code>) <code>HTTP_PATH</code> The HTTP path to your SQL warehouse or cluster (e.g., <code>/sql/1.0/warehouses/abc</code>) <code>CATALOG</code> The Unity Catalog name to use <code>SCHEMA</code> The schema name within the catalog"},{"location":"database-connections/#example_2","title":"Example","text":"<pre><code># jetbase/env.py\nsqlalchemy_url = \"databricks://token:dapi1234567890abcdef@adb-1234567890123456.cloud.databricks.comt?http_path=/sql/1.0/warehouses/abc123def456&amp;catalog=main&amp;schema=default\"\n</code></pre>"},{"location":"getting-started/","title":"Getting Started \ud83d\ude80","text":"<p>This guide will walk you through setting up Jetbase from scratch. By the end, you'll have a fully working migration system for your database!</p>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, make sure you have:</p> <ul> <li>Python 3.10+ installed</li> <li>A database (PostgreSQL, SQLite, Snowflake, MySQL, Databricks)</li> <li>pip or uv for installing packages</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":"<p>Install Jetbase using pip:</p> <pre><code>pip install jetbase\n</code></pre> <p>Note for Snowflake and Databricks Users: To use Jetbase with Snowflake or Databricks, install the appropriate extras:</p> <pre><code>pip install \"jetbase[snowflake]\"\npip install \"jetbase[databricks]\"\n</code></pre> <p>Verify the installation:</p> <pre><code>jetbase --help\n</code></pre> <p>You should see a list of available commands. \ud83c\udf89</p>"},{"location":"getting-started/#setting-up-your-project","title":"Setting Up Your Project","text":""},{"location":"getting-started/#step-1-initialize-jetbase","title":"Step 1: Initialize Jetbase","text":"<p>Navigate to your project directory and run:</p> <pre><code>jetbase init\n</code></pre> <p>This creates a <code>jetbase/</code> directory with the following structure:</p> <pre><code>jetbase/\n\u251c\u2500\u2500 migrations/     # Your SQL migration files go here\n\u2514\u2500\u2500 env.py          # Database configuration\n</code></pre>"},{"location":"getting-started/#step-2-navigate-to-the-jetbase-directory","title":"Step 2: Navigate to the Jetbase Directory","text":"<pre><code>cd jetbase\n</code></pre> <p>Important</p> <p>All Jetbase commands must be run from inside the <code>jetbase/</code> directory.</p>"},{"location":"getting-started/#step-3-configure-your-database-connection","title":"Step 3: Configure Your Database Connection","text":"<p>Open <code>env.py</code> and update the <code>sqlalchemy_url</code> with your database connection string:</p> PostgreSQLSQLiteMySQLSnowflakeDatabricks <pre><code>sqlalchemy_url = \"postgresql+psycopg2://user:password@localhost:5432/mydb\"\n</code></pre> <pre><code>sqlalchemy_url = \"sqlite:///mydb.db\"\n</code></pre> <pre><code>sqlalchemy_url = \"mysql+pymysql://user:password@localhost:3306/mydb\"\n</code></pre> <pre><code>sqlalchemy_url = (\n    \"snowflake://&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;ACCOUNT&gt;/&lt;DATABASE&gt;/&lt;SCHEMA&gt;?warehouse=&lt;WAREHOUSE&gt;\"\n)\n</code></pre> <pre><code>sqlalchemy_url = (\n    \"databricks://token:&lt;ACCESS_TOKEN&gt;@&lt;HOSTNAME&gt;?http_path=&lt;HTTP_PATH&gt;&amp;catalog=&lt;CATALOG&gt;&amp;schema=&lt;SCHEMA&gt;\"\n)\n</code></pre>"},{"location":"getting-started/#creating-your-first-migration","title":"Creating Your First Migration","text":""},{"location":"getting-started/#step-1-generate-a-migration-file","title":"Step 1: Generate a Migration File","text":"<p>Use the <code>new</code> command to create a migration file:</p> <pre><code>jetbase new \"create users table\" -v 1\n</code></pre> <p>This creates a file like:</p> <pre><code>migrations/V1__create_users_table.sql\n</code></pre> <p>The filename format is: <code>V{version}__{description}.sql</code></p> <p>Manual Migration Files</p> <p>You can also create migration files manually if you prefer! Simply add your migration file to the <code>jetbase/migrations/</code> folder and follow the required filename format: <code>V{version}__{description}.sql</code> Example: <code>V2.4__create_users_table.sql</code></p> <p>Be sure your file starts with <code>V</code>, followed by a version (like <code>2.4</code>), then <code>__</code>, a short description (use underscores for spaces), and ends with <code>.sql</code>.</p>"},{"location":"getting-started/#step-2-write-your-migration-sql","title":"Step 2: Write Your Migration SQL","text":"<p>Open the newly created file and add your SQL statements:</p> <pre><code>-- upgrade\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL\n);\n\nCREATE TABLE items (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n);\n\n-- rollback\nDROP TABLE items;\nDROP TABLE users;\n</code></pre> <p>Migration File Structure</p> <ul> <li>The <code>-- rollback</code> section contains only SQL to undo the migration, and any rollback statements must go after <code>-- rollback</code></li> </ul>"},{"location":"getting-started/#step-3-apply-the-migration","title":"Step 3: Apply the Migration","text":"<p>Run the upgrade command:</p> <pre><code>jetbase upgrade\n</code></pre> <p>Output:</p> <pre><code>Migration applied successfully: V1__create_users_table.sql\n</code></pre> <p>Note: Jetbase uses SQLAlchemy under the hood to manage database connections. For any database other than SQLite, you must install the appropriate Python database driver. For example, to use Jetbase with PostgreSQL: <pre><code>pip install psycopg2\n</code></pre> You can also use another compatible driver if you prefer (such as <code>asyncpg</code>, <code>pg8000</code>, etc.).</p>"},{"location":"getting-started/#step-4-verify-the-migration","title":"Step 4: Verify the Migration","text":"<p>Check the migration status:</p> <pre><code>jetbase status\n</code></pre> <p>You'll see a table showing:</p> <ul> <li>\u2705 Applied migrations</li> <li>\ud83d\udccb Pending migrations (if any)</li> </ul>"},{"location":"getting-started/#whats-next","title":"What's Next?","text":"<p>Now that you've set up your first migration, explore these topics:</p> <ul> <li>Writing Migrations \u2014 Learn about migration file syntax and best practices</li> <li>Commands Reference \u2014 Discover all available commands</li> <li>Rollbacks \u2014 Learn how to safely undo migrations</li> <li>Configuration Options \u2014 Customize Jetbase behavior</li> </ul>"},{"location":"getting-started/#quick-command-reference","title":"Quick Command Reference","text":"Command Description <code>init</code> Initialize Jetbase in current directory <code>new</code> Create a new migration file <code>upgrade</code> Apply pending migrations <code>rollback</code> Undo migrations <code>status</code> Show migration status of all migration files (applied vs. pending) <code>history</code> Show migration history <code>current</code> Show latest version migrated <code>lock-status</code> Check if migrations are locked <code>unlock</code> Remove migration lock <code>validate-checksums</code> Verify migration file integrity <code>validate-files</code> Check for missing migration files <code>fix</code> Fix migration issues <code>fix-files</code> Fix missing migration files (same as <code>validate-files --fix</code>) <code>fix-checksums</code> Fix migration file checksums (same as <code>validate-checksums --fix</code>)"},{"location":"advanced/","title":"Advanced Topics","text":""},{"location":"advanced/#migration-types","title":"Migration Types","text":"<p>Jetbase supports three types of migrations: Versioned, Runs Always, and Runs On Change. Versioned migrations cover most use cases, but the repeatable types are useful for specialized cases.</p> <p>\u2192 Learn about Migration Types</p>"},{"location":"advanced/#migration-locking","title":"Migration Locking","text":"<p>Jetbase automatically locks the database during migrations to prevent conflicts when multiple processes try to migrate simultaneously.</p> <p>\u2192 Learn about Locking</p>"},{"location":"advanced/migration-locking/","title":"Migration Locking","text":"<p>Suppose two developers or AI agents both run <code>jetbase upgrade</code> at the same time.</p> <p>Without any locking, both processes could try to change the database together. This might cause errors, data corruption, or broken migrations.</p> <p>Jetbase solves this with automatic migration locking. Only one process can run migrations at a time. </p>"},{"location":"advanced/migration-locking/#what-is-migration-locking","title":"What Is Migration Locking?","text":"<p>When you run <code>jetbase upgrade</code>, Jetbase grabs a lock before touching your database. Think of it like putting a \"Do Not Disturb\" sign on your migrations. No other process can run migrations until the first one finishes.</p> <p>Jetbase automatically acquires a lock whenever you run any command that might modify the <code>jetbase_migrations</code> table. This includes commands like <code>jetbase upgrade</code>, <code>jetbase rollback</code>, and all <code>fix</code> operations. By doing this, Jetbase ensures that your migrations always run safely without any risk of collision.</p> <p>You shouldn't need to think about locking at all! With Jetbase, it just works out of the box!</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Process A   \u2502                     \u2502  Process B   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502                                    \u2502\n       \u25bc                                    \u2502\n   \ud83d\udd12 Acquire lock                          \u2502\n       \u2502                                    \u2502\n       \u25bc                                    \u25bc\n   Run migrations               \ud83d\udeab \"Lock is held, please try again later\"\n       \u2502                                    \u2502\n       \u25bc                                    \u2502\n   \ud83d\udd13 Release lock \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n       \u2502                                    \u2502\n       \u25bc                                    \u25bc\n     Done!                            \ud83d\udd04 Retry\n                                            \u2502\n                                            \u25bc\n                                      \ud83d\udd12 Acquire lock\n                                            \u2502\n                                            \u25bc\n                                       Run migrations\n                                            \u2502\n                                            \u25bc\n                                      \ud83d\udd13 Release lock\n                                            \u2502\n                                            \u25bc\n                                          Done!\n</code></pre>"},{"location":"advanced/migration-locking/#why-does-this-matter","title":"Why Does This Matter?","text":"<p>Without locking, bad things can happen:</p> Scenario What Goes Wrong Two AI agents or developers attempt to run migrations simultaneously Each agent might attempt conflicting schema changes or partial upgrades, risking schema drift or inconsistent data Multiple app instances start simultaneously Migration history gets corrupted Two CI/CD pipelines deploy at once Both try to create the same table \u2192 one fails <p>Locking ensures exactly one migration process runs at a time. Simple as that.</p>"},{"location":"advanced/migration-locking/#how-it-works","title":"How It Works","text":"<p>Jetbase stores lock state in a <code>jetbase_lock</code> table in your database:</p> Column Description <code>is_locked</code> <code>true</code> when migrations are running <code>locked_at</code> Timestamp when the lock was acquired <code>process_id</code> Unique ID of the process holding the lock <p>The magic happens in three steps:</p> <ol> <li>Acquire \u2192 Before running any SQL, Jetbase tries to set <code>is_locked = true</code></li> <li>Run \u2192 If successful, migrations proceed</li> <li>Release \u2192 When done (success or failure), the lock is released</li> </ol> <p>If the lock is already held? Jetbase immediately fails with a helpful message instead of waiting forever.</p>"},{"location":"advanced/migration-locking/#checking-lock-status","title":"Checking Lock Status","text":"<p>Curious if something's holding the lock?</p> <pre><code>jetbase lock-status\n</code></pre> <p>When unlocked (normal state): <pre><code>Status: UNLOCKED\n</code></pre></p> <p>When locked (migration in progress): <pre><code>Status: LOCKED\nLocked At: 2025-12-25 14:30:22.123456\n</code></pre></p>"},{"location":"advanced/migration-locking/#releasing-a-stuck-lock","title":"Releasing a Stuck Lock","text":"<p>Sometimes things go wrong\u2014a process crashes mid-migration, your laptop dies, or the connection drops. The lock stays acquired even though nothing is running.</p> <p>If you're 100% sure no migration is actually running:</p> <pre><code>jetbase unlock\n</code></pre> <p>Output: <pre><code>Unlock successful.\n</code></pre></p> <p>Be Careful!</p> <p>Only use <code>unlock</code> when you're absolutely certain no migration is in progress. Unlocking while a migration is actually running can corrupt your database.</p> <pre><code>### \ud83d\udd04 Concurrent Deploys\n\n```bash\n# Server 1\njetbase upgrade  # Acquires lock, runs migrations...\n\n# Server 2 (at the same time)\njetbase upgrade  # Fails immediately with \"Lock is already held\"\n</code></pre> <p>Server 2 gets a clear error. No corruption, no race conditions.</p>"},{"location":"advanced/migration-locking/#lock-commands-reference","title":"Lock Commands Reference","text":"Command What It Does <code>jetbase lock-status</code> Check if database is locked <code>jetbase unlock</code> Force-release the lock"},{"location":"advanced/migration-types/","title":"Migration Types \ud83d\udd04","text":"<p>Jetbase supports three flexible types of migrations to fit a variety of database needs: Versioned, Runs Always, and Runs on Change.</p> <p>FOR ALMOST ALL USE CASES, VERSIONED MIGRATIONS ARE ALL YOU\u2019LL EVER NEED.</p> <ul> <li>Versioned migrations \u2014 the standard and most common type, referenced throughout the docs. These are what you\u2019ll use for almost every change to your database.</li> <li>Runs Always migrations \u2014 designed for cases where you want a migration to run every time you upgrade, perfect for things like refreshing views or permissions.</li> <li>Runs On Change migrations \u2014 ideal when you want a migration to run only if its contents have been modified, great for managing stored procedures or functions.</li> </ul>"},{"location":"advanced/migration-types/#overview","title":"Overview","text":"Type Prefix Runs When Notes Versioned <code>V</code> Once, in order Perfect for most use cases Runs Always <code>RA__</code> Every upgrade Runs On Change <code>ROC__</code> When file changes"},{"location":"advanced/migration-types/#versioned-migrations-v","title":"Versioned Migrations (<code>V</code>)","text":"<p>The most common type. These run once, in sequential order, and are tracked by version number.</p>"},{"location":"advanced/migration-types/#filename-format","title":"Filename Format","text":"<pre><code>V{YYYYMMDD.HHMMSS}__{description}.sql\n</code></pre>"},{"location":"advanced/migration-types/#examples","title":"Examples","text":"<pre><code>V20251225.100000__create_users_table.sql\nV1__add_email_to_users.sql\nV2.1__create_orders_table.sql\n</code></pre>"},{"location":"advanced/migration-types/#when-to-use","title":"When to Use","text":"<ul> <li>Creating or altering tables</li> <li>Adding or removing columns</li> <li>Creating indexes</li> <li>Data migrations</li> <li>Any change that should only run once</li> </ul>"},{"location":"advanced/migration-types/#example-file","title":"Example File","text":"<pre><code>-- upgrade\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    email VARCHAR(255) NOT NULL UNIQUE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- rollback\nDROP TABLE IF EXISTS users;\n</code></pre>"},{"location":"advanced/migration-types/#how-they-work","title":"How They Work","text":"<ol> <li>Jetbase reads all <code>V*</code> files and sorts them by version</li> <li>Compares with applied migrations in the database</li> <li>Applies pending migrations in order</li> <li>Records each migration after successful execution</li> </ol>"},{"location":"advanced/migration-types/#repeatable-always-ra__","title":"Repeatable Always (<code>RA__</code>)","text":"<p>These migrations run on every upgrade, regardless of whether they've changed.</p>"},{"location":"advanced/migration-types/#filename-format_1","title":"Filename Format","text":"<p><pre><code>RA__{description}.sql\n</code></pre> Runs Always migrations don\u2019t use a version number - just a clear, descriptive name!</p>"},{"location":"advanced/migration-types/#examples_1","title":"Examples","text":"<pre><code>RA__refresh_materialized_views.sql\nRA__update_permissions.sql\nRA__rebuild_indexes.sql\n</code></pre>"},{"location":"advanced/migration-types/#when-to-use_1","title":"When to Use","text":"<ul> <li>Refreshing materialized views</li> <li>Rebuilding indexes</li> <li>Resetting permissions or roles</li> <li>Any operation that needs to run every time</li> </ul>"},{"location":"advanced/migration-types/#example-file_1","title":"Example File","text":"<pre><code>-- upgrade\nREFRESH MATERIALIZED VIEW CONCURRENTLY user_statistics;\nREFRESH MATERIALIZED VIEW CONCURRENTLY order_summary;\n\n-- Grant permissions\nGRANT SELECT ON user_statistics TO readonly_role;\nGRANT SELECT ON order_summary TO readonly_role;\n\n-- rollback\n-- Usually no rollback needed for RA migrations\n</code></pre>"},{"location":"advanced/migration-types/#how-they-work_1","title":"How They Work","text":"<ol> <li>After versioned migrations complete</li> <li>Jetbase runs all <code>RA__*</code> files</li> <li>Every <code>RA__</code> file runs on every upgrade</li> </ol> <p>Tip</p> <p>Keep <code>RA__</code> migrations idempotent (safe to run multiple times).</p>"},{"location":"advanced/migration-types/#repeatable-on-change-roc__","title":"Repeatable On Change (<code>ROC__</code>)","text":"<p>These migrations run only when the file content has changed since the last run.</p>"},{"location":"advanced/migration-types/#filename-format_2","title":"Filename Format","text":"<p><pre><code>ROC__{description}.sql\n</code></pre> Runs On Change migrations don\u2019t use a version number - just a clear, descriptive name!</p>"},{"location":"advanced/migration-types/#examples_2","title":"Examples","text":"<pre><code>ROC__stored_procedures.sql\nROC__functions.sql\nROC__triggers.sql\nROC__views.sql\n</code></pre>"},{"location":"advanced/migration-types/#when-to-use_2","title":"When to Use","text":"<ul> <li>Stored procedures</li> <li>Database functions</li> <li>Triggers</li> <li>Views (non-materialized)</li> <li>Any code that can be safely re-created</li> </ul>"},{"location":"advanced/migration-types/#example-file_2","title":"Example File","text":"<pre><code>-- upgrade\nCREATE OR REPLACE FUNCTION calculate_order_total(order_id INTEGER)\nRETURNS DECIMAL AS $$\nBEGIN\n    RETURN (\n        SELECT SUM(price * quantity)\n        FROM order_items\n        WHERE order_items.order_id = $1\n    );\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION update_timestamp()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.updated_at = CURRENT_TIMESTAMP;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- rollback\nDROP FUNCTION IF EXISTS update_timestamp();\nDROP FUNCTION IF EXISTS calculate_order_total(INTEGER);\n</code></pre>"},{"location":"advanced/migration-types/#how-they-work_2","title":"How They Work","text":"<ol> <li>Jetbase calculates a checksum of the file</li> <li>Compares with the stored checksum from last run</li> <li>If different (or never run), executes the migration</li> <li>Updates the stored checksum</li> </ol>"},{"location":"advanced/migration-types/#why-use-roc-over-v","title":"Why Use ROC Over V?","text":"<p>For functions and procedures, you often want to:</p> <ul> <li>Edit the same file as the function evolves</li> <li>Avoid creating many versioned migrations for small changes</li> <li>Keep related code together in one file</li> </ul> <p>Compare:</p> <p>With Versioned Migrations:</p> <pre><code>V20251225.100000__create_calc_total_function.sql\nV20251226.100000__update_calc_total_v2.sql\nV20251227.100000__update_calc_total_v3.sql\nV20251228.100000__fix_calc_total_bug.sql\n</code></pre> <p>With Repeatable On Change:</p> <pre><code>ROC__order_functions.sql  # Just edit this file\n</code></pre>"},{"location":"advanced/migration-types/#execution-order","title":"Execution Order","text":"<p>When you run <code>jetbase upgrade</code>, migrations execute in this order:</p> <ol> <li>Versioned migrations \u2014 In version order (oldest first)</li> <li>Repeatable On Change \u2014 Files that have changed</li> <li>Repeatable Always \u2014 All RA files</li> </ol> <pre><code>[Upgrade Start]\n    \u2502\n    \u251c\u2500\u2500 V20251225.100000__create_users.sql\n    \u251c\u2500\u2500 V20251225.110000__create_orders.sql\n    \u251c\u2500\u2500 V20251225.120000__add_index.sql\n    \u2502\n    \u251c\u2500\u2500 ROC__stored_procedures.sql (if changed)\n    \u251c\u2500\u2500 ROC__functions.sql (if changed)\n    \u2502\n    \u251c\u2500\u2500 RA__refresh_views.sql\n    \u2514\u2500\u2500 RA__update_permissions.sql\n    \u2502\n[Upgrade Complete]\n</code></pre>"},{"location":"advanced/migration-types/#choosing-the-right-type-use-versioned-migrations-for-almost-all-use-cases","title":"Choosing the Right Type (Use Versioned migrations for almost all use cases!)","text":""},{"location":"advanced/migration-types/#use-versioned-v-when","title":"Use Versioned (<code>V</code>) When:","text":"<ul> <li>Making schema changes (CREATE, ALTER, DROP)</li> <li>Migrating data between tables</li> <li>Changes that must run exactly once</li> <li>Order of execution matters</li> </ul>"},{"location":"advanced/migration-types/#use-repeatable-always-ra__-when","title":"Use Repeatable Always (<code>RA__</code>) When:","text":"<ul> <li>Operations need to run every deployment</li> <li>Refreshing cached/computed data</li> <li>Maintenance tasks</li> </ul>"},{"location":"advanced/migration-types/#use-repeatable-on-change-roc__-when","title":"Use Repeatable On Change (<code>ROC__</code>) When:","text":"<ul> <li>Managing stored procedures/functions</li> <li>Creating / updating views</li> </ul>"},{"location":"commands/","title":"Commands Reference \ud83d\udee0\ufe0f","text":"<p>Jetbase provides a set of intuitive commands to manage your database migrations. This section covers all available commands and their options.</p>"},{"location":"commands/#quick-reference","title":"Quick Reference","text":"Command Description <code>init</code> Initialize Jetbase in current directory <code>new</code> Create a new migration file <code>upgrade</code> Apply pending migrations <code>rollback</code> Undo migrations <code>status</code> Show migration status of all migration files (applied vs. pending) <code>history</code> Show migration history <code>current</code> Show latest version migrated <code>lock-status</code> Check if migrations are locked <code>unlock</code> Remove migration lock <code>validate-checksums</code> Verify migration file integrity <code>validate-files</code> Check for missing migration files <code>fix</code> Fix migration issues <code>fix-files</code> Fix missing migration files (same as <code>validate-files --fix</code>) <code>fix-checksums</code> Fix migration file checksums (same as <code>validate-checksums --fix</code>)"},{"location":"commands/#command-categories","title":"Command Categories","text":""},{"location":"commands/#setup-commands","title":"\ud83d\ude80 Setup Commands","text":"<p>Commands to initialize and set up your migration environment:</p> <ul> <li><code>init</code> \u2014 Create the Jetbase directory structure</li> </ul>"},{"location":"commands/#migration-commands","title":"\ud83d\udcdd Migration Commands","text":"<p>Commands to create and run migrations:</p> <ul> <li><code>new</code> \u2014 Generate a new migration file</li> <li><code>upgrade</code> \u2014 Apply pending migrations to the database</li> <li><code>rollback</code> \u2014 Undo one or more migrations</li> </ul>"},{"location":"commands/#status-commands","title":"\ud83d\udcca Status Commands","text":"<p>Commands to check the state of your migrations:</p> <ul> <li><code>status</code> \u2014 See applied and pending migrations</li> <li><code>history</code> \u2014 View complete migration history</li> <li><code>current</code> \u2014 Show the latest applied version</li> </ul>"},{"location":"commands/#lock-commands","title":"\ud83d\udd12 Lock Commands","text":"<p>Commands to manage migration locking:</p> <ul> <li><code>lock-status</code> \u2014 Check if the database is locked</li> <li><code>unlock</code> \u2014 Manually release the migration lock</li> </ul>"},{"location":"commands/#maintenance-commands","title":"\ud83d\udd27 Maintenance Commands","text":"<p>Commands to validate and fix migration issues:</p> <ul> <li><code>validate-checksums</code> \u2014 Check for modified migration files</li> <li><code>validate-files</code> \u2014 Check for missing files</li> <li><code>fix</code> \u2014 Automatically repair common issues</li> </ul>"},{"location":"commands/#getting-help","title":"Getting Help","text":"<p>Every command has a <code>--help</code> option:</p> <pre><code>jetbase --help           # General help\njetbase upgrade --help   # Help for upgrade command\njetbase rollback --help  # Help for rollback command\n</code></pre>"},{"location":"commands/current/","title":"jetbase current","text":"<p>Show the latest applied migration version.</p>"},{"location":"commands/current/#usage","title":"Usage","text":"<pre><code>jetbase current\n</code></pre>"},{"location":"commands/current/#description","title":"Description","text":"<p>The <code>current</code> command displays the version number of the most recently applied migration. It's a quick way to check where your database schema currently stands.</p>"},{"location":"commands/current/#output","title":"Output","text":""},{"location":"commands/current/#when-migrations-have-been-applied","title":"When Migrations Have Been Applied","text":"<pre><code>jetbase current\n</code></pre> <p>Output:</p> <pre><code>Latest migration version: 20251225.143022\n</code></pre>"},{"location":"commands/current/#when-no-migrations-have-been-applied","title":"When No Migrations Have Been Applied","text":"<pre><code>jetbase current\n</code></pre> <p>Output:</p> <pre><code>No migrations have been applied yet.\n</code></pre>"},{"location":"commands/current/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>Shows only the version of the latest versioned migration</li> </ul>"},{"location":"commands/fix/","title":"jetbase fix","text":"<p>Repair migration files and checksums in one command.</p>"},{"location":"commands/fix/#usage","title":"Usage","text":"<pre><code>jetbase fix\n</code></pre>"},{"location":"commands/fix/#description","title":"Description","text":"<p>The <code>fix</code> command is a convenience command that repairs both file issues and checksum issues. It's equivalent to running:</p> <pre><code>jetbase validate-files --fix\njetbase validate-checksums --fix\n</code></pre> <p>Use this when you want to quickly resolve migration drift without running multiple commands.</p> <p>For detailed explanations of what each validation does and when to use <code>--fix</code>, see:</p> <ul> <li><code>validate-files</code> \u2014 Fix missing migration files or database history</li> <li><code>validate-checksums</code> \u2014 Fix modified or out-of-sync migration file checksums</li> </ul> <p>See the Validations Overview for a comprehensive guide to every validation check Jetbase performs with <code>jetbase fix</code>.</p>"},{"location":"commands/history/","title":"jetbase history","text":"<p>Shows you which migrations have been applied to your database, and the exact time each one was applied.</p>"},{"location":"commands/history/#usage","title":"Usage","text":"<pre><code>jetbase history\n</code></pre>"},{"location":"commands/history/#description","title":"Description","text":"<p>The <code>history</code> command displays a detailed table of all migrations that have been applied to the database, including when they were applied and in what order. This is useful for auditing and understanding the evolution of your database schema.</p>"},{"location":"commands/history/#output","title":"Output","text":"<p>The command displays a formatted table with:</p> <ul> <li>Version \u2014 The migration version number</li> <li>Order Executed \u2014 The sequence in which the migration was applied</li> <li>Description \u2014 The migration description (from the filename)</li> <li>Applied At \u2014 The timestamp when the migration was applied</li> </ul>"},{"location":"commands/history/#examples","title":"Examples","text":""},{"location":"commands/history/#basic-usage","title":"Basic Usage","text":"<pre><code>jetbase history\n</code></pre>"},{"location":"commands/history/#typical-output","title":"Typical Output","text":"<pre><code>                              Migration History\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Order Executed \u2503 Description            \u2503 Applied At             \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 1                 \u2502 1              \u2502 create_users_table     \u2502 2025-12-20 10:15:32.12 \u2502\n\u2502 2                 \u2502 2              \u2502 add_email_to_users     \u2502 2025-12-21 09:45:18.54 \u2502\n\u2502 3                 \u2502 3              \u2502 create_orders_table    \u2502 2025-12-22 14:22:07.89 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"commands/history/#when-no-migrations-have-been-applied","title":"When No Migrations Have Been Applied","text":"<pre><code>jetbase history\n</code></pre> <p>Output:</p> <pre><code>No migrations have been applied yet.\n</code></pre>"},{"location":"commands/history/#understanding-the-output","title":"Understanding the Output","text":""},{"location":"commands/history/#version-column","title":"Version Column","text":"<ul> <li>Versioned migrations show the version (e.g., <code>20251220.100000</code>, <code>2.4</code>)</li> <li>Repeatable migrations show their type (see Migration Types):</li> <li><code>RUNS_ALWAYS</code></li> <li><code>RUNS_ON_CHANGE</code></li> </ul>"},{"location":"commands/history/#order-executed","title":"Order Executed","text":"<p>The sequential order in which migrations were applied to the database. This is useful for:</p> <ul> <li>Understanding the timeline of changes</li> <li>Debugging issues that appeared after a specific migration</li> <li>Auditing purposes</li> <li>For repeatable migrations, the order executed that is displayed will show the order during first time it was run (the applied at section will show the most recent timestamp of when it was run)</li> </ul>"},{"location":"commands/history/#applied-at","title":"Applied At","text":"<p>The exact timestamp when the migration was applied. The format is:</p> <pre><code>YYYY-MM-DD HH:MM:SS.microseconds\n</code></pre>"},{"location":"commands/history/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> </ul>"},{"location":"commands/init/","title":"jetbase init","text":"<p>Initialize Jetbase in your current directory.</p>"},{"location":"commands/init/#usage","title":"Usage","text":"<pre><code>jetbase init\n</code></pre>"},{"location":"commands/init/#description","title":"Description","text":"<p>The <code>init</code> command sets up Jetbase in your project by creating the necessary directory structure and configuration files. This is typically the first command you run when setting up Jetbase for a new project.</p>"},{"location":"commands/init/#what-it-creates","title":"What It Creates","text":"<p>Running <code>jetbase init</code> creates a <code>jetbase/</code> directory with:</p> <pre><code>jetbase/\n\u251c\u2500\u2500 migrations/     # Directory for your SQL migration files\n\u2514\u2500\u2500 env.py          # Configuration file for database connection\n</code></pre>"},{"location":"commands/init/#the-envpy-file","title":"The <code>env.py</code> File","text":"<p>The generated configuration file looks like this:</p> <pre><code># Jetbase Configuration\n# Update the sqlalchemy_url with your database connection string.\n\nsqlalchemy_url = \"postgresql://user:password@localhost:5432/mydb\"\n</code></pre> <p>Important</p> <p>After running <code>init</code>, you need to update the <code>sqlalchemy_url</code> in <code>env.py</code> with your actual database connection string.</p> <p>Next Step: After running <code>jetbase init</code>, move into the <code>jetbase</code> directory with:</p> <pre><code>cd jetbase\n</code></pre> <p>Important: All future <code>jetbase</code> commands should be run inside the <code>jetbase</code> directory.</p>"},{"location":"commands/init/#examples","title":"Examples","text":""},{"location":"commands/init/#basic-usage","title":"Basic Usage","text":"<pre><code># In your project root\njetbase init\n</code></pre> <p>Output:</p> <pre><code>Initialized Jetbase project in /path/to/your/project/jetbase\nRun 'cd jetbase' to get started!\n</code></pre>"},{"location":"commands/init/#complete-workflow","title":"Complete Workflow","text":"<pre><code># 1. Initialize Jetbase\njetbase init\n\n# 2. Move into the jetbase directory\ncd jetbase\n\n# 3. Edit env.py with your database URL\n# (use your favorite editor)\n\n# 4. Create your first migration\njetbase new \"create users table\" -v 1\n\n# 5. Apply migrations\njetbase upgrade\n</code></pre>"},{"location":"commands/init/#notes","title":"Notes","text":"<ul> <li>All other Jetbase commands must be run from inside the <code>jetbase/</code> directory.</li> <li>The <code>migrations/</code> directory will be empty after initialization. Use <code>jetbase new</code> to create your first migration, (or create migration files manually. See Migrations Overview).</li> </ul>"},{"location":"commands/lock-status/","title":"jetbase lock-status","text":"<p>Check if the database migration lock is active.</p>"},{"location":"commands/lock-status/#usage","title":"Usage","text":"<pre><code>jetbase lock-status\n</code></pre>"},{"location":"commands/lock-status/#description","title":"Description","text":"<p>The <code>lock-status</code> command shows whether the database is currently locked for migrations. Jetbase uses a locking mechanism to prevent multiple migration processes from running simultaneously, which could cause database corruption.</p>"},{"location":"commands/lock-status/#output","title":"Output","text":""},{"location":"commands/lock-status/#when-unlocked-normal-state","title":"When Unlocked (Normal State)","text":"<pre><code>jetbase lock-status\n</code></pre> <p>Output:</p> <pre><code>Status: UNLOCKED\n</code></pre> <p>This is the normal state. You can safely run migrations.</p>"},{"location":"commands/lock-status/#when-locked","title":"When Locked","text":"<pre><code>jetbase lock-status\n</code></pre> <p>Output:</p> <pre><code>Status: LOCKED\nLocked At: 2025-12-25 14:30:22.123456\n</code></pre> <p>This indicates that a migration process is currently in progress. Please wait for it to finish before attempting any further actions. </p> <p>If you are absolutely certain that no migration or fix command is active, you may use <code>jetbase unlock</code> to safely release the lock (see <code>unlock</code> for details).</p>"},{"location":"commands/lock-status/#how-locking-works","title":"How Locking Works","text":"<ol> <li>Before migrations run, Jetbase locks other migrations from running</li> <li>During migrations, the lock prevents other processes from starting migrations</li> <li>After migrations complete, the lock is automatically released</li> </ol> <p>For a detailed explanation of how migration locking works, see Migration Locking.</p> <ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>The lock is stored in the <code>jetbase_lock</code> database table</li> <li>Locks are automatically released whether the migration was successful or an error occurred.</li> </ul>"},{"location":"commands/new/","title":"jetbase new","text":"<p>Create a new migration file with a specified version.</p>"},{"location":"commands/new/#usage","title":"Usage","text":"<pre><code>jetbase new \"description of the migration\" -v &lt;version&gt;\n</code></pre>"},{"location":"commands/new/#description","title":"Description","text":"<p>The <code>new</code> command generates a new SQL migration file in the <code>migrations/</code> directory. The file is named with the provided version number and description.</p> <p>If you do not provide a version, the file generated will use the current timestamp as the version.</p>"},{"location":"commands/new/#arguments","title":"Arguments","text":"Argument Required Description <code>description</code> Yes A brief description of what the migration does"},{"location":"commands/new/#options","title":"Options","text":"Option Required Description <code>-v</code>, <code>--version</code> No The version number for the migration (e.g., <code>1</code>, <code>1.5</code>, <code>2_1</code>). If not provided, a timestamp is used."},{"location":"commands/new/#filename-format","title":"Filename Format","text":"<p>The generated filename follows this pattern:</p> <pre><code># with version provided\nV&lt;version&gt;__&lt;description&gt;.sql\n\n#without version provided\nV&lt;YYYYMMDD.HHMMSS&gt;__&lt;description&gt;.sql\n</code></pre> <p>For example, with <code>-v 1</code>:</p> <pre><code>V1__create_users_table.sql\n</code></pre> <p>Or without <code>-v</code> (uses timestamp):</p> <pre><code>V20251225.143022__create_users_table.sql\n</code></pre> <ul> <li><code>V</code> \u2014 Indicates a versioned migration</li> <li><code>1</code> or <code>20251225.143022</code> \u2014 Version number or timestamp</li> <li><code>create_users_table</code> \u2014 Your description (spaces replaced with underscores)</li> <li><code>.sql</code> \u2014 File extension</li> </ul> <p>Manual Migration Files</p> <p>You don't have to use the <code>jetbase new</code> CLI command to add a migration! You can manually create a migration file in the required format:</p> <pre><code>V&lt;version&gt;__&lt;description&gt;.sql\n</code></pre> <p>Examples: - <code>V1__create_users_table.sql</code> - <code>V1.1__create_users_table.sql</code></p> <p>Just ensure your filename starts with <code>V</code>, followed by a version (or timestamp), double underscore <code>__</code>, a short description (use underscores for spaces), and ends with <code>.sql</code>.</p>"},{"location":"commands/new/#examples","title":"Examples","text":""},{"location":"commands/new/#basic-usage","title":"Basic Usage","text":"<pre><code>jetbase new \"create users table\" -v 1\n</code></pre> <p>Output:</p> <pre><code>Created migration file: V1__create_users_table.sql\n</code></pre>"},{"location":"commands/new/#the-generated-file","title":"The Generated File","text":"<p>The command creates an empty SQL file. You'll need to add your migration SQL:</p> <pre><code>-- upgrade\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE items (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    price NUMERIC(10, 2) NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n\n-- rollback\nDROP TABLE IF EXISTS items;\nDROP TABLE IF EXISTS users;\n</code></pre> <p>Best Practice</p> <p>Include <code>-- rollback</code> sections. This allows you to safely undo migrations if needed.</p>"},{"location":"commands/new/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>Use <code>-v</code> to specify a custom version number (e.g., <code>1</code>, <code>1.5</code>)</li> <li>If <code>-v</code> is not provided, a timestamp-based version is automatically generated</li> <li>You do not have to use the <code>jetbase new</code> CLI command to create a new migration. You can create a new file manually in the <code>jetbase/migrations</code> directory and follow the <code>V&lt;version&gt;__&lt;description&gt;.sql</code> naming convention. For full details and best practices, see Migrations Overview.</li> </ul>"},{"location":"commands/rollback/","title":"jetbase rollback","text":"<p>Undo one or more migrations.</p>"},{"location":"commands/rollback/#usage","title":"Usage","text":"<pre><code>jetbase rollback\n</code></pre>"},{"location":"commands/rollback/#description","title":"Description","text":"<p>The <code>rollback</code> command undoes applied migrations by executing the <code>-- rollback</code> section of migration files. This is essential for recovering from mistakes or reverting changes during development.</p>"},{"location":"commands/rollback/#options","title":"Options","text":"Option Short Description <code>--count</code> <code>-c</code> Number of migrations to roll back <code>--to-version</code> <code>-t</code> Roll back to a specific version (exclusive) <code>--dry-run</code> <code>-d</code> Preview the rollback without executing it"},{"location":"commands/rollback/#default-behavior","title":"Default Behavior","text":"<p>When called without options, <code>rollback</code> undoes only the last migration:</p> <pre><code>jetbase rollback\n</code></pre> <p>This is equivalent to:</p> <pre><code>jetbase rollback --count 1\n</code></pre>"},{"location":"commands/rollback/#examples","title":"Examples","text":""},{"location":"commands/rollback/#roll-back-the-last-migration","title":"Roll Back the Last Migration","text":"<pre><code>jetbase rollback\n</code></pre> <p>Output:</p> <pre><code>Rollback applied successfully: V10__add_email_to_users.sql\n</code></pre>"},{"location":"commands/rollback/#rollback-multiple-migrations","title":"Rollback Multiple Migrations","text":"<pre><code># Roll back the last 3 migrations\njetbase rollback --count 3\n</code></pre> <p>Output:</p> <pre><code>Rollback applied successfully: V10__add_email_to_users.sql\nRollback applied successfully: V9__add_index_on_users.sql\nRollback applied successfully: V8__create_users_table.sql\n</code></pre>"},{"location":"commands/rollback/#roll-back-to-a-specific-version","title":"Roll Back to a Specific Version","text":"<pre><code># Roll back everything after version 20251225.143022\njetbase rollback --to-version 5\n</code></pre> <p>Note</p> <p>The specified version will remain applied. Only migrations after it are rolled back.</p>"},{"location":"commands/rollback/#preview-a-rollback-dry-run","title":"Preview a Rollback (Dry Run)","text":"<pre><code>jetbase rollback --dry-run\n</code></pre> <p>Output:</p> <pre><code>=== DRY RUN MODE ===\nThe following migrations would be rolled back:\n\n--- V10__add_email_to_users.sql ---\nALTER TABLE users DROP COLUMN email;\n\n=== END DRY RUN ===\n</code></pre>"},{"location":"commands/rollback/#combine-options","title":"Combine Options","text":"<pre><code># Dry-run rolling back 2 migrations\njetbase rollback --count 2 --dry-run\n</code></pre>"},{"location":"commands/rollback/#important-considerations","title":"Important Considerations","text":""},{"location":"commands/rollback/#migration-files-must-exist","title":"Migration Files Must Exist","text":"<p>Rollback requires the original migration files to be present. If a file is missing:</p> <pre><code>Migration file for version '7' not found. Cannot proceed with rollback.\nPlease restore the missing migration file and try again, or run 'jetbase fix'\nto synchronize the migrations table with existing files before retrying the rollback.\n</code></pre> <p>Solutions:</p> <ol> <li>Restore the missing migration file to its correct location.</li> <li>Alternatively, run <code>jetbase fix</code> to synchronize the migrations table with the current set of files. Note: This will remove references to the missing migration from tracking. If you need to roll back past that point in the future, you'll need to write a new migration file to handle it safely.</li> </ol>"},{"location":"commands/rollback/#order-of-rollback","title":"Order of Rollback","text":"<p>Migrations are rolled back in reverse order (newest first). This ensures dependencies are handled correctly.</p>"},{"location":"commands/rollback/#write-good-rollback-sql","title":"Write Good Rollback SQL","text":"<p>Your rollback SQL should completely undo the upgrade:</p> <pre><code>-- upgrade\nCREATE TABLE orders (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER REFERENCES users(id),\n    total DECIMAL(10,2)\n);\nCREATE INDEX idx_orders_user_id ON orders(user_id);\n\n-- rollback\nDROP INDEX IF EXISTS idx_orders_user_id;\nDROP TABLE IF EXISTS orders;\n</code></pre>"},{"location":"commands/rollback/#error-handling","title":"Error Handling","text":"<p>If a rollback fails:</p> <ul> <li>The failed migration remains in the database</li> <li>Fix the rollback statement directly in the migration file ( there is no checksum validation for rollback statements)</li> <li>If you are rolling back multiple migrations in a single command:<ul> <li>Any migrations that are successfully rolled back before an error will remain rolled back</li> <li>If a failure occurs, all SQL statements for that migration\u2019s rollback section are aborted</li> <li>Migrations scheduled to roll back after the failed one will not be attempted</li> </ul> </li> </ul> <pre><code># Check current state of what migrations have been applied and what is pending\njetbase status\n</code></pre>"},{"location":"commands/rollback/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>Rollbacks are applied in reverse chronological order</li> <li>Cannot use both <code>--count</code> and <code>--to-version</code> together</li> </ul>"},{"location":"commands/status/","title":"jetbase status","text":"<p>Displays which migrations have been applied and which migrations are pending.</p>"},{"location":"commands/status/#usage","title":"Usage","text":"<pre><code>jetbase status\n</code></pre>"},{"location":"commands/status/#description","title":"Description","text":"<p>The <code>status</code> command gives you a clear overview of your migration state, showing both applied migrations and pending ones.</p>"},{"location":"commands/status/#basic-usage","title":"Basic Usage","text":"<pre><code>jetbase status\n</code></pre>"},{"location":"commands/status/#typical-output","title":"Typical Output","text":"<pre><code>                    Migrations Applied\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                          \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 1                 \u2502 create_users_table                   \u2502\n\u2502 2                 \u2502 add_email_to_users                   \u2502\n\u2502 3                 \u2502 create_orders_table                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                    Migrations Pending\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                          \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 4                 \u2502 add_products_table                   \u2502\n\u2502 5                 \u2502 add_shipping_info                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"commands/status/#when-everything-is-up-to-date","title":"When Everything Is Up to Date","text":"<pre><code>                    Migrations Applied\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                          \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 1                 \u2502 create_users_table                   \u2502\n\u2502 2                 \u2502 add_email_to_users                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                    Migrations Pending\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                          \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502                                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"commands/status/#fresh-database-no-migrations-applied","title":"Fresh Database (No Migrations Applied)","text":"<pre><code>                    Migrations Applied\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                          \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502                                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                    Migrations Pending\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                          \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 20251220.100000   \u2502 create_users_table                   \u2502\n\u2502 20251221.093000   \u2502 add_email_to_users                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"commands/status/#migration-type-indicators","title":"Migration Type Indicators","text":"<p>The status command shows different prefixes for migration types:</p> Prefix Meaning <code>1</code> Versioned migration (standard) <code>RUNS_ALWAYS</code> Runs Always migration <code>RUNS_ON_CHANGE</code> Runs On Change migration <p>Example: <pre><code>\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Version           \u2503 Description                  \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 1                 \u2502 create_users_table           \u2502\n\u2502 2                 \u2502 add_email_to_users           \u2502\n\u2502 3                 \u2502 create_orders_table          \u2502\n\u2502 RUNS_ALWAYS       \u2502 refresh_materialized_views   \u2502 \n\u2502 RUNS_ON_CHANGE    \u2502 stored_procedures            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre></p>"},{"location":"commands/status/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>Compares files in <code>migrations/</code> with database records</li> </ul>"},{"location":"commands/unlock/","title":"jetbase unlock","text":"<p>Manually release the migration lock.</p>"},{"location":"commands/unlock/#usage","title":"Usage","text":"<pre><code>jetbase unlock\n</code></pre>"},{"location":"commands/unlock/#description","title":"Description","text":"<p>The <code>unlock</code> command forcefully releases the migration lock, allowing migrations to run again. This should only be used when you're certain that no migration is currently in progress.</p> <p>Use With Caution</p> <p>Only use this command when you're absolutely certain no migration process is running.</p>"},{"location":"commands/unlock/#output","title":"Output","text":"<pre><code>jetbase unlock\n</code></pre> <p>Output:</p> <pre><code>Unlock successful.\n</code></pre>"},{"location":"commands/unlock/#when-to-use","title":"When to Use","text":""},{"location":"commands/unlock/#safe-to-unlock","title":"\u2705 Safe to Unlock","text":"<ul> <li>The lock is stale from a crashed process</li> <li>You've verified no migration is running (checked processes, team members, AI agents)</li> <li>You're in a development environment and want to reset state</li> </ul>"},{"location":"commands/unlock/#do-not-unlock-if","title":"\u274c Do NOT Unlock If","text":"<ul> <li>A migration might still be running</li> <li>You're unsure what's happening</li> </ul>"},{"location":"commands/upgrade/","title":"jetbase upgrade","text":"<p>Apply pending migrations to your database.</p>"},{"location":"commands/upgrade/#usage","title":"Usage","text":"<pre><code>jetbase upgrade\n</code></pre>"},{"location":"commands/upgrade/#description","title":"Description","text":"<p>The <code>upgrade</code> command applies all pending migrations to your database in order. It's the most commonly used command for keeping your database schema up to date.</p>"},{"location":"commands/upgrade/#options","title":"Options","text":"Option Short Description <code>--count</code> <code>-c</code> Number of migrations to apply <code>--to-version</code> <code>-t</code> Apply migrations up to a specific version <code>--dry-run</code> <code>-d</code> Preview changes without applying them <code>--skip-validation</code> Skip all validation checks <code>--skip-checksum-validation</code> Skip checksum validation only <code>--skip-file-validation</code> Skip file validation only"},{"location":"commands/upgrade/#examples","title":"Examples","text":""},{"location":"commands/upgrade/#apply-all-pending-migrations","title":"Apply All Pending Migrations","text":"<pre><code>jetbase upgrade\n</code></pre> <p>This applies all pending migrations in order.</p>"},{"location":"commands/upgrade/#apply-a-specific-number-of-migrations","title":"Apply a Specific Number of Migrations","text":"<pre><code># Apply only the next 2 migrations\njetbase upgrade --count 2\n</code></pre>"},{"location":"commands/upgrade/#apply-up-to-a-specific-version","title":"Apply Up to a Specific Version","text":"<pre><code># Apply all migrations up to and including version 5\njetbase upgrade --to-version 5\n</code></pre>"},{"location":"commands/upgrade/#preview-changes-dry-run","title":"Preview Changes (Dry Run)","text":"<pre><code>jetbase upgrade --dry-run\n</code></pre> <p>This shows you what migrations would be applied without actually running them. Great for verifying before deployment!</p> <p>Output example:</p> <pre><code>=== DRY RUN MODE ===\nThe following migrations would be applied:\n\n--- V1__create_users_table.sql ---\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    username VARCHAR(50) NOT NULL\n);\n\n--- V2__add_email_to_users.sql ---\nALTER TABLE users ADD COLUMN email VARCHAR(255);\n\n=== END DRY RUN ===\n</code></pre>"},{"location":"commands/upgrade/#skip-validation","title":"Skip Validation","text":"<pre><code># Skip all validation (use with caution!)\njetbase upgrade --skip-validation\n\n# Skip only checksum validation\njetbase upgrade --skip-checksum-validation\n\n# Skip only file validation\njetbase upgrade --skip-file-validation\n</code></pre> <p>Warning</p> <p>Skipping validation can lead to inconsistent database state. Only use these options if you understand the implications. To learn more, see Validations.</p>"},{"location":"commands/upgrade/#migration-types","title":"Migration Types","text":"<p>During upgrade, Jetbase processes three types of migrations. Most developers will only ever need to worry about the standard Versioned Migrations. </p>"},{"location":"commands/upgrade/#versioned-migrations-v","title":"Versioned Migrations (<code>V*</code>)","text":"<p>Standard migrations that run once, in version order.</p> <pre><code>V20251225.143022__create_users_table.sql\n</code></pre>"},{"location":"commands/upgrade/#runs-always-ra__","title":"Runs Always (<code>RA__*</code>)","text":"<p>Migrations that run on every upgrade.</p> <pre><code>RA__refresh_views.sql\n</code></pre>"},{"location":"commands/upgrade/#runs-on-change-roc__","title":"Runs On Change (<code>ROC__*</code>)","text":"<p>Migrations that run only when the file content changes.</p> <pre><code>ROC__update_view.sql\n</code></pre> <p>Learn more in Migration Types.</p>"},{"location":"commands/upgrade/#error-handling","title":"Error Handling","text":"<p>Jetbase is designed to keep your database safe even when something goes wrong. If a migration fails during an upgrade:</p> <ol> <li>No Partial Changes: The failed migration file will not be applied at all. Any statements within that file are rolled back, so your database remains unchanged by that migration.</li> <li>Orderly Progress: All prior migration files that completed successfully in during that same upgrade command remain applied. Any migration files scheduled to run after the failed one are skipped.</li> <li>Clear Feedback: You\u2019ll see a descriptive error message explaining what went wrong, so you can fix the issue and try again.</li> </ol> <p>Jetbase stops safely at the first sign of trouble, preventing partial or out-of-order migrations.</p>"},{"location":"commands/upgrade/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>Cannot use both <code>--count</code> and <code>--to-version</code> together</li> <li>The automatic lock prevents concurrent migrations from causing conflicts</li> </ul>"},{"location":"commands/validate-checksums/","title":"jetbase validate-checksums","text":"<p>Verify that migration files haven't been modified since they were applied.</p>"},{"location":"commands/validate-checksums/#what-is-a-checksum","title":"What Is a Checksum?","text":"<p>A checksum is a unique \"fingerprint\" calculated from the contents of your migration file. When you apply a migration, Jetbase stores this fingerprint. Later, it can verify the file hasn't changed by recalculating the fingerprint and comparing.</p>"},{"location":"commands/validate-checksums/#usage","title":"Usage","text":"<pre><code>jetbase validate-checksums\n</code></pre> <pre><code>## Options\n\n| Option  | Short | Description                                    |\n| ------- | ----- | ---------------------------------------------- |\n| `--fix` | `-f`  | Update stored checksums to match current files |\n</code></pre> <p>Tip: You can use either  </p> <p><pre><code>jetbase validate-checksums --fix\n</code></pre> or the shortcut: <pre><code>jetbase fix-checksums\n</code></pre></p> <p>Both commands are identical </p>"},{"location":"commands/validate-checksums/#description","title":"Description","text":"<p>The <code>validate-checksums</code> command compares the checksums of your migration files against the checksums stored in the database. This helps detect if someone has modified a migration file after it was applied, which could indicate:</p> <ul> <li>Accidental edits to applied migrations</li> <li>Intentional changes that need to be handled</li> <li>File corruption</li> </ul> <p>When working with AI agents to generate or manage code, it's easy for files to be changed in ways you might not expect. For example, an agent could accidentally revise an old migration file instead of creating a new one when implementing a new feature.</p> <p>This kind of modification can be risky: without proper checksum validation, the altered migration might not run, leading to differences (\"drift\") between environments such as local, development, staging, and production.</p> <p>In these situations, some environments may end up applying the old version of a migration file, while others run the new one\u2014resulting in inconsistent database schemas across your projects. Regular checksum validation helps catch these issues early and is especially important when collaborating with both developers and AI agents.</p>"},{"location":"commands/validate-checksums/#examples","title":"Examples","text":""},{"location":"commands/validate-checksums/#audit-mode-default","title":"Audit Mode (Default)","text":"<p>Check for checksum mismatches without making changes:</p> <pre><code>jetbase validate-checksums\n</code></pre> <p>If all checksums match:</p> <pre><code>All migration checksums are valid - no altered upgrade statments detected.\n</code></pre> <p>If mismatches are found:</p> <pre><code>JETBASE - Checksum Audit Report\n----------------------------------------\nChanges detected in the following files:\n \u2192 3\n \u2192 7\n</code></pre>"},{"location":"commands/validate-checksums/#fix-mode","title":"Fix Mode","text":"<p>Update stored checksums to match the current file contents:</p> <pre><code>jetbase validate-checksums --fix\n</code></pre> <p>Output:</p> <pre><code>Fixed checksum for version: 3\nFixed checksum for version: 7\n</code></pre> <pre><code>Original file \u2192 Checksum: abc123\nModified file \u2192 Checksum: xyz789  \u2190 Different! File was changed\n</code></pre>"},{"location":"commands/validate-checksums/#why-do-checksums-matter","title":"Why Do Checksums Matter?","text":""},{"location":"commands/validate-checksums/#preventing-confusion","title":"Preventing Confusion","text":"<p>If a migration file is modified after being applied:</p> <ul> <li>The database has the original changes</li> <li>The file has different content</li> <li>Future deployments might be confusing</li> </ul>"},{"location":"commands/validate-checksums/#team-coordination","title":"Team Coordination","text":"<p>Checksums help catch when:</p> <ul> <li>Someone edits an already-applied migration instead of creating a new one</li> <li>Merge conflicts corrupt a migration file</li> <li>Local changes weren't properly committed</li> </ul>"},{"location":"commands/validate-checksums/#best-practices","title":"Best Practices","text":"<ol> <li>Never modify applied migrations \u2014 Always create new migrations for changes</li> <li>Run checksum validation in CI/CD \u2014 Catch issues before deployment</li> <li>Use <code>--fix</code> sparingly \u2014 Only when you understand why the mismatch exists</li> </ol>"},{"location":"commands/validate-checksums/#notes","title":"Notes","text":"<ul> <li>Must be run from inside the <code>jetbase/</code> directory</li> <li>Only validates migrations that have been applied</li> <li>Only uses upgrade SQL statements in the migration file to calculate checksums</li> </ul>"},{"location":"commands/validate-files/","title":"jetbase validate-files","text":"<p>Check for missing migration files, out of order migrations, and if files have </p>"},{"location":"commands/validate-files/#usage","title":"Usage","text":"<pre><code>jetbase validate-files\n</code></pre>"},{"location":"commands/validate-files/#description","title":"Description","text":"<p>The <code>validate-files</code> command performs the following checks:</p> <ul> <li>Ensures every migration recorded in the database still has its corresponding SQL file (detects missing, deleted, or moved files)</li> <li>Warns if any new migration file has a lower version than those already migrated (out-of-order migrations)</li> <li>Verifies that all migration versions are unique (prevents duplicates)</li> </ul> <p>For detailed explanations of these checks, see Validations.</p>"},{"location":"commands/validate-files/#options","title":"Options","text":"Option Short Description <code>--fix</code> <code>-f</code> Remove database records for missing files <p>Tip: You can use either  </p> <p><pre><code>jetbase validate-files --fix\n</code></pre> or the shortcut: <pre><code>jetbase fix-files\n</code></pre></p> <p>Both commands are identical </p>"},{"location":"commands/validate-files/#examples","title":"Examples","text":""},{"location":"commands/validate-files/#audit-mode-default","title":"Audit Mode (Default)","text":"<p>Check for missing files without making changes:</p> <pre><code>jetbase validate-files\n</code></pre> <p>If all files exist:</p> <pre><code>All migrations have corresponding files.\n</code></pre> <p>If files are missing:</p> <pre><code>The following migrations are missing their corresponding files:\n\u2192 4\n\u2192 9\n</code></pre>"},{"location":"commands/validate-files/#fix-mode","title":"Fix Mode","text":"<p>Remove records of migrations whose files no longer exist:</p> <pre><code>jetbase validate-files --fix\n</code></pre> <p>Output:</p> <pre><code>Stopped tracking the following missing versions:\n\u2192 4\n\u2192 9\n</code></pre>"},{"location":"commands/validate-files/#database-integrity","title":"Database Integrity","text":"<p>Missing files can indicate:</p> <ul> <li>Accidental deletions</li> <li>Incomplete git operations</li> <li>Merge conflicts that removed files</li> </ul>"},{"location":"commands/validate-files/#team-coordination","title":"Team Coordination","text":"<p>Helps identify when:</p> <ul> <li>Someone forgot to commit new migrations</li> <li>Files were removed in a PR that shouldn't have been</li> </ul>"},{"location":"commands/validate-files/#what-fix-does","title":"What <code>--fix</code> Does","text":"<p>When you run <code>validate-files --fix</code>:</p> <ol> <li>Identifies migrations without corresponding files</li> <li>Removes those records from the database</li> <li>Reports what was removed</li> </ol> <p>Warning</p> <p>Using <code>--fix</code> means Jetbase will forget those migrations ever happened. The database changes from those migrations remain, but Jetbase won't track them anymore.</p>"},{"location":"commands/validate-files/#when-to-use-fix","title":"When to Use <code>--fix</code>","text":"<p>\u2705 Safe to fix when:</p> <ul> <li>The file was intentionally removed and won't be needed</li> <li>You're cleaning up after a failed experiment</li> </ul> <p>\u274c Don't fix when:</p> <ul> <li>You need to roll back those migrations later</li> <li>Other team members might have the files</li> <li>You're not sure why the files are missing</li> </ul>"},{"location":"migrations/","title":"Migrations Overview","text":"<p>Learn how to write and organize database migrations with Jetbase.</p>"},{"location":"migrations/#what-are-migrations","title":"What are Migrations?","text":"<p>Migrations are SQL files that describe changes to your database schema. They let you:</p> <ul> <li>Version control your database schema alongside your code</li> <li>Apply changes consistently across development, staging, and production</li> <li>Rollback changes when something goes wrong</li> <li>Collaborate with your team on database changes</li> </ul>"},{"location":"migrations/#quick-start","title":"Quick Start","text":""},{"location":"migrations/#create-a-migration","title":"Create a Migration","text":"<p>You can create migrations in two ways:</p> <p>Option 1: Using the CLI</p> <pre><code>jetbase new \"create users table\" -v 1\n\n# if you want a timestamp-based version, do not specify a version\njetbase new \"create users table\"\n</code></pre> <p>This automatically generates a properly formatted migration file.</p> <p>Option 2: Creating files manually</p> <p>Create a file in your <code>migrations/</code> directory following the naming convention:</p> <pre><code>V&lt;version&gt;__&lt;description&gt;.sql\n</code></pre> <p>Examples: <code>V1__create_users_table.sql</code>, <code>V1.1__add_email_column.sql</code></p>"},{"location":"migrations/#migration-version-order","title":"Migration Version Order","text":"<p>Jetbase always applies migrations in version order\u2014from lowest to highest.</p> <p>Whenever you add a new migration file, make sure its version number is higher than any migration that\u2019s already been applied.</p> <p>If you accidentally create a migration with a lower version number than the last one applied, Jetbase will catch it and let you know before anything happens.</p> <p>This simple check helps keep your migration history clean, safe, and easy to follow!</p> <p>Versioning Example</p> <ul> <li>\u2705 Good: <code>V1.1__create_table.sql</code> &gt; <code>V1.2__add_column.sql</code></li> <li>\u274c Bad: <code>V1.2__add_column.sql</code> (already applied)   New file: <code>V1.1__add_last_name_column.sql</code> \u2190 lower version!</li> </ul> <p>If you ever need to bypass this check (not recommended), you have two options:</p> <ul> <li> <p>Command-line:   Add <code>--skip-file-validation</code> when running <code>jetbase upgrade</code>:   <pre><code>jetbase upgrade --skip-file-validation\n</code></pre></p> </li> <li> <p>Configuration:   Set <code>skip_file_validation = True</code> in your <code>env.py</code> or <code>pyproject.toml</code>.</p> </li> </ul> <p>Warning</p> <p>If you skip this check, Jetbase will simply ignore any migration file whose version is lower than the last applied migration\u2014no error message will be shown, and that migration won't be run.</p>"},{"location":"migrations/#writing-the-migration-file","title":"Writing the Migration File","text":"<p>Writing Jetbase SQL migration files is easy! Just follow these simple guidelines:</p> <ul> <li>Multiple Statements: Add as many SQL statements as you need. Just make sure each one ends with a semicolon (<code>;</code>).</li> <li>Upgrade &amp; Rollback Sections: Separate your upgrade statements from rollback statements by adding a line with <code>-- rollback</code>. (Any variation in case and spacing works: <code>--rollback</code>, <code>-- ROLLBACK</code>, etc.)</li> <li> <p>Section Rules: Only a single upgrade section and a single rollback section are allowed. Everything above the first <code>-- rollback</code> is considered an upgrade; everything below is a rollback.</p> <p>\ud83d\udca1 You don't have to include a <code>-- rollback</code> section (though it's highly recommended!). If you leave it out, Jetbase will treat all SQL statements in the file as upgrade statements.</p> </li> <li> <p>Comments: Feel free to include comments! Just start a line with <code>--</code> and Jetbase will ignore it.</p> </li> </ul> <p>That\u2019s it!</p> <p>Examples:</p> <pre><code>CREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    email VARCHAR(255) NOT NULL UNIQUE\n);\n\nCREATE TABLE items (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n);\n\n-- rollback\nDROP TABLE IF EXISTS users;\nDROP TABLE IF EXISTS items;\n</code></pre> <pre><code>-- upgrade\n\n-- my first comment\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    email VARCHAR(255) NOT NULL UNIQUE\n);\n\n-- my second comment\nCREATE TABLE items (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n);\n\n-- rollback\nDROP TABLE IF EXISTS items;\nDROP TABLE IF EXISTS users;\n</code></pre> <pre><code>CREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    email VARCHAR(255) NOT NULL UNIQUE\n);\n\n-- items table\nCREATE TABLE items (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n);\n</code></pre>"},{"location":"migrations/#apply-it","title":"Apply It","text":"<pre><code>jetbase upgrade\n</code></pre>"},{"location":"migrations/#migration-lifecycle","title":"Migration Lifecycle","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Create    \u2502 \u2500\u2500\u25b6 \u2502    Write    \u2502 \u2500\u2500\u25b6 \u2502   Apply     \u2502\n\u2502 jetbase new \u2502     \u2502    SQL      \u2502     \u2502  upgrade    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                              \u2502\n                                              \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   Rollback  \u2502 \u25c0\u2500\u2500 \u2502   Oops?     \u2502\n                    \u2502  if needed  \u2502     \u2502             \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"migrations/#file-naming","title":"File Naming","text":"Type Pattern Example Versioned <code>V{version}__{desc}.sql</code> <code>V1__create_users.sql</code> Runs Always <code>RA__{desc}.sql</code> <code>RA__refresh_views.sql</code> Runs On Change <code>ROC__{desc}.sql</code> <code>ROC__functions.sql</code>"},{"location":"migrations/#best-practices","title":"Best Practices","text":"<ol> <li>One change per migration \u2014 Keep migrations focused</li> <li>Include rollback \u2014 Even if it's just <code>DROP TABLE</code></li> <li>Use descriptive names \u2014 Future you will thank you</li> <li>Test locally first \u2014 Use dry-run before production</li> <li>Don't modify applied migrations \u2014 Create new ones instead</li> </ol>"},{"location":"migrations/#in-file-configuration","title":"In-File Configuration","text":""},{"location":"migrations/#custom-delimiter","title":"Custom Delimiter","text":"<p>By default, Jetbase splits SQL statements on semicolons (<code>;</code>). However, when working with stored procedures, functions, or triggers that contain semicolons in their body, you may need a custom delimiter.</p> <p>Add a special comment at the top of your migration file to specify a custom delimiter:</p> <pre><code>-- jetbase: delimiter=&lt;delimiter&gt;\n</code></pre> <p>In this example below, the delimiter to split SQL statements on in the file will be ~ <pre><code>-- jetbase: delimiter=~\n</code></pre></p> <p>In this example, the delimiter to split SQL statements on in the file will be ~</p> <p>Example file:</p> <pre><code>-- jetbase: delimiter=~\n\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    email TEXT NOT NULL,\n    updated_at TIMESTAMP\n);~\n\nCREATE OR REPLACE FUNCTION set_updated_at()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.updated_at = NOW();\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;~\n\nCREATE TRIGGER users_updated_at\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_updated_at();~\n\n-- rollback\nDROP TRIGGER IF EXISTS users_updated_at ON users;~\nDROP FUNCTION IF EXISTS set_updated_at();~\nDROP TABLE IF EXISTS users;~\n</code></pre> <p>Note</p> <p>The <code>-- jetbase: delimiter=</code> directive must appear before any SQL statements (comments are okay).</p>"},{"location":"validations/","title":"Validations","text":"<p>Jetbase performs several validations before applying migrations to ensure database integrity and prevent common mistakes. These checks run automatically during <code>jetbase upgrade</code> and help catch issues before they cause problems in your database.</p> <p>Jetbase's validations act as guardrails to:</p> <ul> <li>Prevent accidental changes to already-applied migrations</li> <li>Ensure migration order is consistent across environments</li> <li>Catch missing files before they cause failures / drift across environments (dev, staging, production)</li> <li>Detect conflicts when multiple AI agents / developers add migrations</li> </ul>"},{"location":"validations/#validation-types","title":"Validation Types","text":"<p>Jetbase performs two categories of validations:</p> Category Config to Skip What It Checks File Validation <code>skip_file_validation</code> Migration file presence and ordering Checksum Validation <code>skip_checksum_validation</code> File content integrity <p>You can also use <code>skip_validation</code> to skip all validations at once.</p>"},{"location":"validations/#file-validations","title":"File Validations","text":"<p>These validations ensure your migration files are properly organized and haven't been removed.</p>"},{"location":"validations/#1-out-of-order-migration-check","title":"1. Out-of-Order Migration Check","text":"<p>What it checks: New migration files must have a version higher than the last applied migration.</p> <p>Why it matters: Migrations are applied in version order. If you add a migration with a lower version than one already applied, it would never run. Jetbase can automatically catch this issue before it causes problems.</p> <p>Example error: <pre><code>V2.4__add_users.sql has version 20240103 which is lower than the \nlatest migrated version 3.1.\nNew migration files cannot have versions lower than the latest migrated version.\nPlease rename the file to have a version higher than 3.1.\n</code></pre></p> <p>How to fix: Rename your migration file to have a version higher than the latest applied migration.</p>"},{"location":"validations/#2-missing-migration-files-check","title":"2. Missing Migration Files Check","text":"<p>What it checks: Every previously applied migration must still have its corresponding file in the migrations directory.</p> <p>Why it matters: If a migration file is deleted, Jetbase can't verify what was applied or perform rollbacks. This also indicates potential sync issues between environments.</p> <p>Example error: <pre><code>Version 2.4 has been migrated but is missing from the current migration files.\n</code></pre></p> <p>How to fix: Restore the missing migration file, or if intentionally removed, use <code>jetbase fix-files</code> to update the migration history.</p>"},{"location":"validations/#3-duplicate-version-check","title":"3. Duplicate Version Check","text":"<p>What it checks: No two migration files can have the same version number.</p> <p>Why it matters: Duplicate versions create ambiguity\u2014Jetbase wouldn't know which migration to apply first, and different environments could end up with different schemas.</p> <p>Example error: <pre><code>Duplicate migration version detected: 2.4.\nEach file must have a unique version.\nPlease rename the file to have a unique version.\n</code></pre></p> <p>How to fix: Rename one of the duplicate files to have a unique version.</p> <p>Note</p> <p>This validation always runs and cannot be skipped.</p>"},{"location":"validations/#checksum-validation","title":"Checksum Validation","text":""},{"location":"validations/#file-content-integrity-check","title":"File Content Integrity Check","text":"<p>What it checks: Applied migration files haven't been modified since they were run.</p> <p>Why it matters: Changing an already-applied migration is dangerous because:</p> <ul> <li>The database already has the old version applied</li> <li>Other environments will apply the new version</li> <li>You end up with inconsistent schemas across environments</li> </ul> <p>Jetbase calculates a SHA-256 checksum of each migration's SQL statements and stores it when the migration is applied. On subsequent upgrades, it recalculates and compares to make sure the sql statements in the have not changeds.</p>"},{"location":"validations/#ai-and-migration-file-modifications","title":"AI and Migration File Modifications","text":"<p>When working with AI agents to generate or manage code, it's easy for files to be changed in ways you might not expect. For example, an agent could accidentally revise an old migration file instead of creating a new one when implementing a new feature.</p> <p>This kind of modification can be risky: without proper checksum validation, the altered migration might not run, leading to differences (\"drift\") between environments such as local, development, staging, and production.</p> <p>In these situations, some environments may end up applying the old version of a migration file, while others run the new one\u2014resulting in inconsistent database schemas across your projects. Regular checksum validation helps catch these issues early and is especially important when collaborating with both humans and AI.</p> <p>Example error: <pre><code>Checksum mismatch for versions: 2.4, 3.1. \nFiles have been changed since migration.\n</code></pre></p> <p>How to fix:</p> <ol> <li>Revert your changes if they were accidental</li> <li>if you need to make schema changes revert your changes in those files and instead make the changes in a new migration file</li> <li>Use <code>jetbase fix-checksums</code> if you intentionally modified the files and understand the risks</li> </ol>"},{"location":"validations/#skipping-validations","title":"Skipping Validations","text":"<p>Use with caution</p> <p>Skipping validations can lead to inconsistent database states. Only skip if you fully understand the implications.</p>"},{"location":"validations/#via-command-line","title":"Via Command Line","text":"<pre><code># Skip all validations\njetbase upgrade --skip-validation\n\n# Skip only file validation\njetbase upgrade --skip-file-validation\n\n# Skip only checksum validation\njetbase upgrade --skip-checksum-validation\n</code></pre>"},{"location":"validations/#via-configuration","title":"Via Configuration","text":"<pre><code># jetbase/env.py\nskip_validation = True           # Skip all\nskip_file_validation = True      # Skip file checks only\nskip_checksum_validation = True  # Skip checksum checks only\n</code></pre>"},{"location":"validations/#validation-commands","title":"Validation Commands","text":"<p>Jetbase provides commands to check validations without running migrations:</p> Command Description <code>jetbase validate-checksums</code> Check for checksum mismatches <code>jetbase validate-checksums --fix</code> Fix checksum mismatches by updating stored checksums <code>jetbase validate-files</code> Check for missing or out-of-order files <code>jetbase fix-checksums</code> Alias for <code>validate-checksums --fix</code>"},{"location":"validations/#best-practices","title":"Best Practices","text":"<ol> <li>Never modify applied migration files \u2014 Create new migrations instead</li> <li>Don't delete migration files \u2014 Keep your full migration history</li> <li>Address validation errors immediately \u2014 Don't skip validations as a workaround</li> </ol>"}]}